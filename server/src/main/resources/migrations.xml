<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
	<property name="now" value="sysdate" dbms="oracle" />
	<property name="now" value="now()" dbms="mysql" />
	<property name="now" value="now()" dbms="postgresql" />
	<changeSet id="1" author="kevin">
		<createTable tableName="snm_niping_result">
			<column name="id" type="bigint" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="account_id" type="varchar(25)" />
			<column name="monitor_id" type="varchar(25)" />
			<column name="task_id" type="varchar(25)" />
			<column name="collected_time" type="int" />
			<column name="type" type="int" />
			<column name="start_time" type="int" />
			<column name="end_time" type="int" />
			<column name="errno" type="int" />
			<column name="avg" type="double" />
			<column name="max" type="double" />
			<column name="min" type="double" />
			<column name="tr" type="double" />
			<column name="av2" type="double" />
			<column name="tr2" type="double" />
			<column name="errmsg" type="blob" />
			<column name="creation_time" type="datetime" />
			<column name="modified_time" type="datetime" />
		</createTable>
		<createTable tableName="snm_task">
			<column name="task_id" type="varchar(25)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="account_id" type="varchar(25)" />
			<column name="name" type="varchar(100)" />
			<column name="interval" type="int" />
			<column name="config_json" type="blob" />
			<column name="status" type="int" />
			<column name="creation_time" type="datetime" />
			<column name="modified_time" type="datetime" />
		</createTable>
		<createTable tableName="snm_monitor">
			<column name="monitor_id" type="varchar(25)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="account_id" type="varchar(25)" />
			<column name="name" type="varchar(100)" />
			<column name="country" type="varchar(50)" />
			<column name="province" type="varchar(50)" />
			<column name="city" type="varchar(50)" />
			<column name="isp" type="varchar(50)" />
			<column name="area" type="varchar(50)" />
			<column name="ip" type="varchar(50)" />
			<column name="niping_t" type="blob" />
			<column name="status" type="int" />
			<column name="creation_time" type="datetime" />
			<column name="modified_time" type="datetime" />
		</createTable>
		<createTable tableName="snm_user">
			<column name="user_id" type="bigint" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="account_id" type="varchar(25)" />
			<column name="name" type="varchar(25)" />
			<column name="login_name" type="varchar(25)" />
			<column name="password" type="varchar(128)" />
			<column name="password_salt" type="varchar(20)" />
			<column name="status" type="int" />
			<column name="creation_time" type="datetime" />
			<column name="modified_time" type="datetime" />
		</createTable>
		<createTable tableName="snm_access_credentials">
			<column name="token" type="varchar(25)">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="account_id" type="varchar(25)" />
			<column name="comment" type="varchar(500)" />
			<column name="expiry_date" type="datetime" />
			<column name="creation_time" type="datetime" />
			<column name="modified_time" type="datetime" />
		</createTable>
		<createIndex tableName="snm_niping_result" indexName="idx_atsm">
			<column name="account_id" />
			<column name="task_id"></column>
			<column name="collected_time"></column>
			<column name="monitor_id"></column>
		</createIndex>
		<createIndex tableName="snm_task" indexName="idx_at">
			<column name="account_id" />
			<column name="task_id" />
		</createIndex>
		<createIndex tableName="snm_monitor" indexName="idx_am">
			<column name="account_id" />
			<column name="monitor_id" />
		</createIndex>
		<createIndex tableName="snm_user" indexName="idx_al">
			<column name="account_id" />
			<column name="login_name" />
		</createIndex>
		<createIndex tableName="snm_access_credentials" indexName="idx_t">
			<column name="token" />
		</createIndex>
		<insert tableName="snm_user">
			<column name="account_id" value="a1" />
			<column name="name" value="Admin" />
			<column name="login_name" value="admin" />
			<!-- password is sap118 -->
			<column name="password"
				value="DE42D48DCFADF42C46B0573E311ACB20D4ED0ADE91F8D8714E3B9B834389210CF36D290517E8B5517FEE1721B9EC09E5F28A4AD22860B6EC446AE61F3C5EC8E8" />
			<column name="password_salt" value="sap998" />
			<column name="status" value="0" />
			<column name="creation_time" valueDate="${now}"></column>
			<column name="modified_time" valueDate="${now}"></column>
		</insert>
		<insert tableName="snm_access_credentials">
			<column name="account_id" value="a1" />
			<column name="token" value="Zb3cVv0qzeNhYZwYbdC" />
			<column name="comment" value="Monitor access credentials for a1 account." />
			<column name="expiry_date" valueDate="2117-01-01 00:00:01" />
			<column name="creation_time" valueDate="${now}"></column>
			<column name="modified_time" valueDate="${now}"></column>
		</insert>
	</changeSet>
</databaseChangeLog>